def jvmTargetForKotlinCompile(Project project, String jvmTarget) {
    project.tasks.all {
        // tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile) fails for init scripts
        if (it.class.name == "org.jetbrains.kotlin.gradle.tasks.KotlinCompile_Decorated") {
            kotlinOptions.jvmTarget = "11"
        }
    }
}

allprojects {
    repositories {
        mavenLocal()
        mavenCentral()
        maven {
            url 'https://maven.pkg.jetbrains.space/public/p/compose/dev'
        }
        google()
    }

    plugins.withId("java-base") {
        java {
            sourceCompatibility = JavaVersion.VERSION_11
            targetCompatibility = JavaVersion.VERSION_11
        }
    }

    plugins.withId("org.jetbrains.kotlin.jvm") {
        jvmTargetForKotlinCompile(project, "11")
    }

    plugins.withId("org.jetbrains.kotlin.multiplatform") {
        jvmTargetForKotlinCompile(project, "11")
    }
}